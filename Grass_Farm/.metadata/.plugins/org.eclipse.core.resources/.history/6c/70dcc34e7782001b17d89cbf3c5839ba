<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ page import="user.UserDAO" %>
<%@ page import="user.User" %>
<%@ page import="bbs.BbsDAO" %>
<%@ page import="bbs.Bbs" %>
<%@ page import="java.io.PrintWriter" %>
<%@ page import="java.util.ArrayList" %>
<%@ page import = "java.util.Calendar" %>
<%@ include file="navbar.jsp" %>
<!DOCTYPE html>
<html>
    <head>
    
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width" initial-scale="1">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    	<link href="https://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
    	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    	<link rel="stylesheet" type="text/css" href="dist/jquery.calmosaic.min.css">
		<title>잔디공작소</title>
        <style>
    
        .container { margin: 150px auto; }
        body { 
        padding-top: 30px; 
        }
      	.navbar-fixed-top{
      		background-color: white;
      	}
        .page-header{
            font-family: 'Playfair Display', serif;
            text-align: left;
        }  
       h1, #ps, #pss{
        	font-family: 'ImcreSoojin';
        }
        @font-face {
            font-family: 'ImcreSoojin';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_20-04@2.3/ImcreSoojin.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }
        #ps{
          	text-align:center;
        	font-size: 18pt;
        }
        #pss{
          	text-align:center;
        	font-size: 60pt;
        	color: green; 	
        }

		</style>
    </head>
    <body>
   		
  			<% 
  			Calendar cal = Calendar.getInstance();
 			UserDAO userDAO=new UserDAO();
  			BbsDAO bbsDAO=new BbsDAO();
			ArrayList<User> user=userDAO.user((String)session.getAttribute("userID"));
			int count=bbsDAO.getCount((String)session.getAttribute("userID"));
			int monthcount=bbsDAO.getmonthCount((String)session.getAttribute("userID"), String.valueOf((cal.get(Calendar.MONTH)+1)));
			
			%>
			
  			 <div class="container">
  			 	<div class="card" style="width:25%;margin-top:40px;display: inline-block;">
  			 		<image class="card-img-top" src="./image/grass.png" id="img_click" style="width:100%">
   			 			<div class="card-body">
  			 				<h4 class="card-title"><%=(String)session.getAttribute("userID")%></h4>
  			 				<span class="glyphicon glyphicon-user" aria-hidden="true"></span>
  			 					<p class="card-text"><%out.print(user.get(0).getUserName());%></p> 			 				
  			 				<span class="glyphicon glyphicon-envelope" aria-hidden="true">
  			 					<p class="card-text"><%out.print(user.get(0).getUserEmail());%></p>		
  			 				</span>
  			 				<br><br>
  			 				
  			 				<a href="#" class="btn btn-success" style="width:100%">수정하기</a>
  			 			</div>	
  				 </div>

  			 		<div class="card" style="width:35%;display: inline-block; ">
  						<div class="card-body">
  			 				<p id="ps"><%out.print(user.get(0).getUserName());%>님의 총 잔디 개수<br>
  								<p id="pss"><%out.print(count);%>개</p>
  								<br><br><br><br><br><br><br><br><br>
  							</p>	
  			 			</div>
  			 		</div>
  			 		
  			 		<div class="card" style="width:35%;display: inline-block; ">
  						<div class="card-body">
  			 				<p id="ps"><%out.print(user.get(0).getUserName());%>님의 <%=cal.get(Calendar.MONTH)+1%>월의 잔디 개수<br>
  						<p id="pss"><%out.print(monthcount);%>개</p>
  						<br><br><br><br><br><br><br><br><br>
  					</p>	
  			 			</div>
  			 		</div>
  			 		

  			 			<div class="modal" id="myModal" tabindex="-1">
  							<div class="modal-dialog">
    						<div class="modal-content">
    					    	<div class="modal-header">
    					    	 <h5 class="modal-title">Profile Modify</h5>
        						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
          						<span aria-hidden="true">&times;</span>
        						</button>
      							</div>
  							<div class="modal-body">
  							<h5>프로필 사진 수정하기</h5>
  							<form method="post" enctype="multipart/form-data" action="upload.jsp">
  								<input type="file" name="bfile" id="bfile">
								<input type="submit" value="업로드">
							</form>
								<script>
    							var fileCheck = document.getElementById("bfile").value;
    							if(!fileCheck){
        							alert("파일을 첨부해 주세요");
        						return false;
    							}
								</script>
  								<hr>
  								<button type="button" class="btn btn-success btn-lg btn-block">기본 이미지로 변경하기</button>
							</div>
							</div>
    						</div>
  							</div>
							</div> 
							
  							<!-- The Modal -->
  							  <script type="text/javascript">
  								var modal = document.getElementById('myModal');

    							// Get the button that opens the modal
    							var btn = document.getElementById("img_click");

   								// Get the <span> element that closes the modal
    							var span = document.getElementsByClassName("close")[0];                                          

    							// When the user clicks on the button, open the modal 
    							btn.onclick = function() {
    							    modal.style.display = "block";
    							}

    							// When the user clicks on <span> (x), close the modal
    							span.onclick = function() {
        							modal.style.display = "none";
    							}

    							// When the user clicks anywhere outside of the modal, close it
    							window.onclick = function(event) {
        							if (event.target == modal) {
            							modal.style.display = "none";
        							}
    							}
    							</script>
    							
    							<div class="container">
        <div class="col-md-12">
            <div id="heatmap-1"></div>
        </div>
    </div>
    <script>
        function randomDate(start, end) {
            var date = new Date(+start + Math.random() * (end - start));
            return moment(date).format('YYYY-MM-DD');
        }

        var events = 5
        var data = [];
        for (var i = 0; i < events; i++) {
            data.push({
                count: parseInt((Math.random() * 200).toFixed(0)),
                date: randomDate(moment().subtract(1, 'year').subtract(5, 'months').format('x'), moment()
                    .format('x'))
            });
        }


        $("#heatmap-1").calmosaic(data, {
          
            lastMonth: moment().month(),
            coloring: "",
            legend: {
                minLabel: "Fewer"
            },
            labels: {
                custom: {
                    monthLabels: "MMM"
                }
            }
        });

        
    </script>



</body>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.24.0/moment.min.js"></script>
    <script src="dist/jquery.calmosaic.min.js"></script>
</html>